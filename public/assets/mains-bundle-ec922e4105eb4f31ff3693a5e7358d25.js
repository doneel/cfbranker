function initPausers(){!function(){dataPauser=new DivPauser(document.querySelector(".rightSide")),codePauser=new DivPauser(document.querySelector(".workPane"))}()}function updateData(e){return teams=dm.updateData(e),dataPauser.off(),runAlgorithm(),teams}function runAlgorithm(){cw.postMessage({newCode:editor.getText(),rawData:dm.getRawData()},"*")}function remap(e){for(var a={},t=0;t<e.length;t++)a[e[t].name]=e[t];for(var n={},o=0;o<e.length;o++)for(var r=e[o],d=0;d<e[o].schedule.length;d++){var s=r.schedule[d];s.opp=a[s.opp],s.team=e[o];var i=n[s.game_code];i?(s.opp_game=i,i.opp_game=s):n[s.game_code]=s}return e}function initializeSaveAsForm(){$("#saveAsForm").submit(function(){savePauser.on(),document.getElementById("saveas_form_code").value=editor.getText(),console.log(editor.getText()),console.log(document.getElementById("saveas_form_code").value)}).bind("ajax:complete",function(){savePauser.off()}).bind("ajax:success",function(e,a){console.log(a),sm.addEntry(a),$("#save_form_id").val(a.id)}).bind("ajax:failure",function(e,a,t){console.log("error!: "+t)})}function initializeSaveForm(){var e=this;$("#saveForm").submit(function(){e.savePauser.on()}),$("#saveForm").bind("ajax:success",function(){e.savePauser.off()})}function getMessage(e){ranker.updateCode(e.data.newCode),ranker.updateData(e.data.rawData),ranker.run()}function buildTeamTile(e,a){var t=document.createElement("div");t.className="teamTile";t.onclick=function(){console.log(a)};var n=document.createElement("div");n.className="numberingDiv",t.appendChild(n);var o=document.createElement("p");o.className="rankNumber",o.innerHTML=e+1,n.appendChild(o);var r=document.createElement("div");r.className="teamSide",t.appendChild(r);var d=document.createElement("div");d.className=" teamLogo";var s=document.createElement("div");s.className+=" team-logo",s.className+=" team"+a.team_code,d.appendChild(s),r.appendChild(d);var i=document.createElement("p");return i.className="teamName",i.innerHTML=a.name,r.appendChild(i),t}function remap(e){for(var a={},t=0;t<e.length;t++)a[e[t].name]=e[t];for(var n={},o=0;o<e.length;o++)for(var r=e[o],d=0;d<e[o].schedule.length;d++){var s=r.schedule[d];s.opp=a[s.opp],s.team=e[o];var i=n[s.game_code];i?(s.opp_game=i,i.opp_game=s):n[s.game_code]=s}return e}$(document).ready(function(){console.log(this),console.log("RUNNING"),initializeSaveForm(),initializeSaveAsForm(),editor=new CodeEditor("codeEditorContainer","javascript",saveCode),expandingDiv=new ExpandingDiv(document.querySelector(".saveBar"),"0%","100%",function(){editor.resize()}),$(function(){$("select").selectric()}),initPausers(),sm=new SavesManager(document.querySelector(".saveBar"),preLoad,loadSave,saveAs,!0,savesArr),function(){savePauser=new DivPauser(document.querySelector(".saveList"))}(),cw=document.querySelector(".resultsPanel").contentWindow,dm=new DataManager(document.querySelector("#yearBox"),document.querySelector("#weekBox"),numWeeksMap,getData,updateData,remap),hD=new MessageButton(document.getElementById("helpIcon"),document.getElementById("helpDialog"),document.getElementById("helpBackground"),"active"),iD=new MessageButton(document.getElementById("infoIcon"),document.getElementById("infoDialog"),document.getElementById("infoBackground"),"active"),shareDialog=new MessageButton(document.getElementById("shareButton"),document.getElementById("shareDialog"),document.getElementById("shareBackground"),"active"),state.signed_in||(sm.setCanSave(!1),hD1=new MessageButton(document.getElementById("newSaveButton"),document.getElementById("loginDialog"),document.getElementById("loginBackground"),"active"),hD2=new MessageButton(document.getElementById("saveButton"),document.getElementById("loginDialog"),document.getElementById("loginBackground"),"active")),$("#helpIcon").css("display","block"),dataPauser.on(),$("iframe.resultsPanel").load(function(){dm.requestData()})});var getData=function(e,a,t){dataPauser.on();$.get("/req_data?year="+e[0]+"&week="+e[1],function(e){a(e,t)})},preLoad=function(){!function(){codePauser.on()}()},loadSave=function(e){codePauser.off(),editor.loadText(e.code),$("#save_form_id").val(e.id),runAlgorithm()},saveAs=function(e){editor.setDefaultText(),document.getElementById("saveas_form_name").value=e,$("#saveAsForm").submit()},saveCode=function(e){return state.signed_in?("undefined"==typeof e&&(e=editor.getText()),document.getElementById("save_form_code").value=e,$("#saveForm").submit(),void 0):!1};window.onload=function(){window.addEventListener?addEventListener("message",getMessage,!1):attachEvent("onmessage",getMessage),ranker=new Ranker(document.querySelector(".rankings"),null,null,buildTeamTile,remap),$(".banner").css("display","none")};